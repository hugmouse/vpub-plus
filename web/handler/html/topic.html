{{ define "breadcrumb" }}<a href="/">boards</a> > <a href="/boards/{{ .board.Id }}">{{ .board.Name }}</a>{{ end }}
{{ define "content"}}
<h1><a href="/">boards</a> > <a href="/boards/{{ .board.Id }}">{{ .board.Name }}</a></h1>
<table class="post">
    {{ range .posts }}
    <tr class="header" id="{{ .Id }}">
        <td>{{ .User.Name }} {{ timeAgo .CreatedAt }}</td>
    </tr>
    <tr>
        <td>
            {{ if eq $.topic.Post.Id .Id }}<h1>{{ .Subject }}</h1>{{ end }}
            {{ gmi2html .Content }}
            {{ if and (eq $.topic.Post.Id .Id) $.logged.IsAdmin }}
            <p><a href="/topics/{{ $.topic.Id }}/edit">edit</a> <a href="/posts/{{ .Id }}/remove">remove</a></p>
            {{ else }}
            {{ if or (hasPermission .User.Name) $.logged.IsAdmin }}
            <p><a href="/posts/{{ .Id }}/edit">edit</a> <a href="/posts/{{ .Id }}/remove">remove</a></p>
            {{ end }}
            {{ end }}
        </td>
    </tr>
    {{ end }}
</table>

<section style="margin-top: 1em;">
    <form action="/posts/save" method="post">
        {{ .csrfField }}
        <input type="hidden" name="topicId" value="{{ .topic.Id }}">
        <input type="hidden" name="boardId" value="{{ .board.Id }}">
        <input type="hidden" name="subject" value="Re: {{ .topic.Post.Subject }}">
        <div class="field">
            <label for="content">Reply to this topic</label>
            <textarea name="content" id="content" style="height: 150px;"></textarea>
        </div>
        <input type="submit" value="Reply">
    </form>
</section>
{{ if not .topic.IsLocked }}
{{ end }}
{{ end }}